<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>
      Situm Capacitor Example
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">

  <ion-card>
    <ion-card-header>
      <ion-card-title>Buildings</ion-card-title>
    </ion-card-header>
    <ion-card-content>

      <ion-button
          expand="block"
          (click)="loadBuildings()"
          [disabled]="positioning || buildings">
          Click me to load buildings
      </ion-button>

      <ion-list *ngIf="buildings">
        <ion-card *ngFor="let b of buildings">
          <ion-item
            (click)="startPositioning(b)"
            [disabled]="positioning">
            <ion-label >{{b.name}} - {{b.buildingIdentifier}}</ion-label>
            <ion-button>
              <ion-icon name="locate" slot="icon-only"></ion-icon>
            </ion-button>
          </ion-item>
          <ion-item>
            <ion-button tab="fetch-building-info" (click)="fetchBuildingInfo(b)">
              <ion-label>Info</ion-label>
            </ion-button>
            <ion-button tab="fetch-indoor-pois" (click)="fetchPois(b)">
              <ion-label>POIs</ion-label>
            </ion-button>
            <ion-button tab="fetch-geofences" (click)="fetchGeofences(b)">
              <ion-label>Fences</ion-label>
            </ion-button>
          </ion-item>
        </ion-card>
        <ion-item>
          <ion-button
            expand="block"
            (click)="startPositioning(null)"
            [disabled]="positioning">
              GLOBAL MODE
          </ion-button>
        </ion-item>
      </ion-list>

    </ion-card-content>
  </ion-card>



  <ion-card
    *ngIf="floors && floors.length > 0">

    <ion-card-header>
      <ion-card-title>Floors</ion-card-title>
    </ion-card-header>

    <ion-card-content>
      <ion-item
        *ngFor="let f of floors">
        <ion-label>{{ f.name }}</ion-label>
        <img width="100" src="{{ f.mapUrl }}" />
      </ion-item>
    </ion-card-content>

  </ion-card>



  <ion-card
    *ngIf="navigation">

    <ion-card-header>
      <ion-card-title>Navigation</ion-card-title>
    </ion-card-header>

    <ion-card-content>
      <ion-item>
        <ion-label style="max-height: 200px; overflow-y: scroll;" text-wrap>{{ navigation }}</ion-label>
      </ion-item>
      <ion-item
        *ngFor="let indication of indications">
        <ion-label>{{ indication.humanReadableMessage }}</ion-label>
      </ion-item>
    </ion-card-content>
  </ion-card>



  <ion-card>

    <ion-card-header>
      <ion-card-title>Status</ion-card-title>
    </ion-card-header>

    <ion-card-content>

      <ion-item>
        <ion-icon name="pin" slot="start"></ion-icon>
        <ion-label>{{ currentStatus }}</ion-label>
        <ion-button
          *ngIf="positioning"
          (click)="stopPositioning()">
          <ion-icon name="stop" slot="icon-only"></ion-icon>
        </ion-button>
        <ion-button
          *ngIf="positioning"
          (click)="requestNav()">
          <ion-icon name="navigate" slot="icon-only"></ion-icon>
        </ion-button>
      </ion-item>

      <ion-item>
        {{ currentPositioningInfo }}
      </ion-item>

    </ion-card-content>
  </ion-card>

</ion-content>
